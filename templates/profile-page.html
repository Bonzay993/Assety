{% extends "inventory.html" %}
{% block content %}
<div class="profile-card">
    <div class="profile-avatar">
        <div class="avatar-circle large">{{ first_name[0] }}{{ last_name[0] }}</div>
    </div>
    <h2 class="profile-title">{{ trans('my_profile') }}</h2>
    <div class="profile-grid">
        <div class="profile-field">
            <label for="profile-first-name">{{ trans('first_name') }}</label>
            <input id="profile-first-name" type="text" value="{{ first_name }}" />
        </div>
        <div class="profile-field">
            <label for="profile-last-name">{{ trans('last_name') }}</label>
            <input id="profile-last-name" type="text" value="{{ last_name }}" />
        </div>
        <div class="profile-field">
            <label for="profile-email">{{ trans('email') }}</label>
            <input id="profile-email" type="email" value="{{ email }}" />
        </div>
        <div class="profile-field">
            <label for="profile-company">{{ trans('company') }}</label>
            <input id="profile-company" type="text" value="{{ company }}" readonly />
        </div>
    </div>
    <div class="profile-actions">
        <button type="button" class="settings-btn update-profile-btn" onclick="updateProfile()">
            {{ trans('save_changes') }}
        </button>
    </div>
</div>
<script>
function updateProfile() {
    const firstName = document.getElementById('profile-first-name').value;
    const lastName = document.getElementById('profile-last-name').value;
    const email = document.getElementById('profile-email').value;

    fetch('/update-profile', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            first_name: firstName,
            last_name: lastName,
            email: email
        })
    })
    .then(response => {
        if (response.ok) {
            alert("{{ trans('profile_updated') }}");
            location.reload();
        } else {
            alert("{{ trans('profile_update_failed') }}");
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert("{{ trans('something_wrong') }}");
    });
}
</script>
{% endblock %}

