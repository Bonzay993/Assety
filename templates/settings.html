{% extends "inventory.html" %}

{% block content %}
<div class="settings-container">
    <h2>{{ trans('settings') }}</h2>

   
 <form id="settings-form">
       <div class="settings-row">
            <label for="dark-mode-toggle">{{ trans('dark_mode') }}</label>
            <div class="settings-field">
                <input id="dark-mode-toggle" type="checkbox" {% if settings.dark_mode %}checked{% endif %}>
                <label for="dark-mode-toggle">Yes</label>
            </div>
        </div>


        <div class="settings-row">
            <label for="idle-timeout-input">{{ trans('auto_logout_time') }}</label>
            <div class="settings-field">
                <input id="idle-timeout-input" type="number" min="1" max="120" value="{{ settings.timeout or 20 }}">
            </div>
        </div>


        <div class="settings-row">
            <label for="email-notifications-toggle">{{ trans('email_notifications') }}</label>
            <div class="settings-field">
                <input id="email-notifications-toggle" type="checkbox" {% if settings.email_notifications %}checked{% endif %}>
                <label for="email-notifications-toggle">Enabled</label>
            </div>
        </div>

        <div class="settings-row">
            <label for="language-select">{{ trans('language') }}</label>
            <div class="settings-field">
                <select id="language-select">
                    <option value="en" {% if settings.language == 'en' %}selected{% endif %}>English</option>
                    <option value="es" {% if settings.language == 'es' %}selected{% endif %}>Spanish</option>
                    <option value="fr" {% if settings.language == 'fr' %}selected{% endif %}>French</option>
                </select>
            </div>
        </div>

        <div class="settings-row">
            <label for="currency-select">{{ trans('currency') }}</label>
            <div class="settings-field">
                <select id="currency-select">
                    <option value="GBP" {% if settings.currency == 'GBP' %}selected{% endif %}>£ Pound</option>
                    <option value="EUR" {% if settings.currency == 'EUR' %}selected{% endif %}>€ Euro</option>
                    <option value="USD" {% if settings.currency == 'USD' %}selected{% endif %}>$ Dollar</option>
                </select>
            </div>
        </div>

        <div class="settings-actions">
            <button type="submit" class="settings-btn save-settings-btn">{{ trans('save') }}</button>
        </div>
    </form>


   
</div>


<script>
    document.getElementById('settings-form').addEventListener('submit', function (e) {
        e.preventDefault();
        const timeout = document.getElementById('idle-timeout-input').value;
        const darkMode = document.getElementById('dark-mode-toggle').checked;
        const emailNotifications = document.getElementById('email-notifications-toggle').checked;
        const language = document.getElementById('language-select').value;
        const currency = document.getElementById('currency-select').value;

        fetch('/save-settings', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
         
            body: JSON.stringify({ timeout: parseInt(timeout), dark_mode: darkMode, email_notifications: emailNotifications, language: language, currency: currency })
        })
        .then(response => {
            if (response.ok) {
                if (darkMode) {
                    document.body.classList.add('dark-mode');
                } else {
                    document.body.classList.remove('dark-mode');
                }
                document.documentElement.setAttribute('lang', language);
                alert('Settings saved.');
                window.location.reload();
            } else {
                alert('Failed to save settings.');
            }
        });
    

      
    });
</script>
{% endblock %}

